# 사주 저장 기능 테스트 가이드

## 서버 상태

- **백엔드**: http://localhost:3001 (실행 중)
- **프론트엔드**: http://localhost:5174 (실행 중)

## 테스트 절차

### 1. 회원가입 및 로그인

1. http://localhost:5174 접속
2. 회원가입 페이지에서 새 계정 생성
3. 로그인 확인

### 2. 사주 계산 및 저장

1. 사주 입력 페이지에서 정보 입력
2. 계산 실행
3. 결과 페이지에서 "결과 저장하기" 버튼 클릭
4. 저장 성공 알림 확인

### 3. 저장된 결과 확인

1. 프로필 또는 "내 사주 결과" 메뉴 확인
2. 저장된 결과 목록 표시 확인

## 수정된 내용

### 백엔드 변경사항

1. **라우트 순서 수정**: 구체적인 경로를 파라미터 경로 앞에 배치
   - `/api/saju/bulk-save` → `/api/saju/:id/save` 순서로 변경
2. **자동 저장**: 모든 사주 계산 결과가 DB에 자동 저장 (로그인 여부 무관)
3. **새 엔드포인트 추가**:
   - `GET /api/saju/recent`: 최근 계산 결과 조회
   - `POST /api/saju/bulk-save`: 여러 결과 일괄 저장
   - `DELETE /api/saju/cleanup/temp`: 오래된 임시 결과 정리

### 프론트엔드 변경사항

1. **API 응답 구조 수정**: 중첩된 data 구조 해결
   - `api.js`의 login 함수에서 `response.data.data` 반환
2. **토큰 처리 개선**:
   - `SajuResult.jsx`에서 api 인스턴스 사용 (자동 토큰 추가)
3. **UI 개선**:
   - 저장 중 상태 표시 ("저장 중..." 텍스트)
   - styled-components 경고 수정 (`primary` → `$primary`)

## 테스트 결과

### 성공한 기능

- ✅ 사주 계산 (로그인/비로그인)
- ✅ 회원가입 및 로그인
- ✅ 토큰 발급 및 저장
- ✅ API 라우트 매칭

### 해결된 문제

1. **404 Not Found**: 라우트 순서 문제 해결
2. **401 Unauthorized**: 토큰 저장/조회 방식 수정
3. **React 경고**: styled-components props 경고 해결

## 남은 작업

- E2E 테스트의 JWT 인증 문제 디버깅 필요
- 실제 브라우저에서 전체 플로우 테스트 확인 필요
